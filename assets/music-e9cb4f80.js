import{d as S,r as d,c as N,b as g,e as C,g as c,n as b,u as m,_ as I,w as D,o as M,h as z,j as p,s as W,k as w,D as q,m as E,E as j,G,H as L,F as B,I as V,t as R,f as U,J as F,p as X,x as J,y as K}from"./index-ba23ccc2.js";const O=S({__name:"index",props:{percentage:{type:Number,default:20},height:{type:Number,default:100}},emits:["move"],setup(s,{emit:f}){const t=s,v=d(""),r=d(!1),a=d(""),h=N(()=>({width:`${t.percentage}%`})),i=N(()=>({left:`calc(${t.percentage<=0?"0.5rem":t.percentage}% - 0.5rem)`})),e=N(()=>a.value.offsetWidth),l=n=>{n.preventDefault(),r.value=!0},y=n=>{if(n.preventDefault(),r.value){let u=0;n.type.includes("touch")?u=n.targetTouches[0].pageX-n.target.offsetLeft:u=n.offsetX,u=u>=0?u:0,f("move",u/e.value*100)}},_=n=>{n.preventDefault(),r.value=!1};return(n,u)=>(g(),C("div",{ref_key:"n",ref:a,onMousedown:l,onMouseup:_,onMouseout:_,onMousemove:y,onTouchstart:l,onTouchend:_,onTouchmove:y,style:b([{height:`${3*s.height}px`},{display:"flex","align-items":"center"}]),class:"event-trigger-content"},[c("div",{class:"progress-container",style:b({height:`${s.height}px`})},[c("div",{class:"sub-line",ref_key:"subNode",ref:v,style:b(m(h))},null,4),c("div",{class:"sub-block",style:b(m(i))},null,4)],4)],36))}});const Q=I(O,[["__scopeId","data-v-f38365a4"]]),H=d(""),Y=s=>{H.value=s};function P(){return{audioNode:H,setAudioNode:Y}}const Z={class:"audio-content"},ee=["src"],te=["src"],ae={class:"control"},ne=S({__name:"audio",props:{src:{type:String}},emits:["prev","next"],setup(s,{expose:f,emit:t}){const v=s,r=V("analyser"),a=V("draw"),{setAudioNode:h}=P(),i=d(""),e=d(!1),l=d(0);f({isVoucl:e}),D(()=>e.value,o=>{o?(r.value.context.state!=="running"&&r.value.context.resume(),i.value.play(),a()):i.value.pause()},{deep:!0}),D(()=>v.src,()=>{y()});const y=()=>{l.value=1},_=()=>{t("prev")},n=()=>{t("next")},u=()=>{e.value=!e.value},x=o=>{l.value=100*o.target.currentTime/o.target.duration},$=o=>{e.value=!1},A=()=>{e.value=!0},T=o=>{l.value=o,i.value.currentTime=i.value.duration*o/100};return M(()=>{h(i.value)}),z(()=>{h(null)}),(o,_e)=>{const k=R("el-icon");return g(),C(B,null,[p(Q,{percentage:l.value,onMove:T,style:{flex:"1"},height:2},null,8,["percentage"]),c("div",Z,[c("audio",{ref_key:"audioNode",ref:i,src:s.src,autoplay:"",onTimeupdate:x,onEnded:$,onPlay:A},[c("source",{type:"mp3",src:s.src},null,8,te),W(" 您的浏览器不支持 audio 元素。 ")],40,ee),c("div",ae,[c("span",{onClick:_,class:"prev"},[p(k,null,{default:w(()=>[p(m(q))]),_:1})]),c("span",{onClick:u,class:"pause"},[e.value?(g(),E(k,{key:0},{default:w(()=>[p(m(j))]),_:1})):(g(),E(k,{key:1},{default:w(()=>[p(m(G))]),_:1}))]),c("span",{onClick:n,class:"next"},[p(k,null,{default:w(()=>[p(m(L))]),_:1})])])])],64)}}});const se=I(ne,[["__scopeId","data-v-91fb8f02"]]),oe=S({__name:"audioBg",setup(s){const{audioNode:f}=P(),t=d(""),v=350,r=150,a=d(""),h=()=>{const e=new(window.AudioContext||window.webkitAudioContext);a.value=e.createAnalyser(),a.value.fftSize=512;var l=e.createMediaElementSource(f.value);l.connect(a.value),a.value.connect(e.destination)},i=()=>{a.value.context.state!=="running"&&a.value.context.resume();var e=a.value.frequencyBinCount,l=new Uint8Array(e),y=v/e*1.5,_;const n=t.value.getContext("2d");function u(){requestAnimationFrame(function(){n.clearRect(0,0,v,r),a.value.getByteFrequencyData(l);let x=0;for(let o=0;o<l.length;o++){_=l[o];var $=_+25*(o/e),A=255*(o/e),T=100;n.fillStyle="rgba("+$+","+A+","+T+",0.5)",n.fillRect(x,r-_,y,_),x+=y+2}u()})}u()};return F("analyser",a),F("draw",i),M(()=>{h()}),(e,l)=>(g(),C(B,null,[c("canvas",{ref_key:"canvasNode",ref:t,style:{width:"100%"},width:"350",height:"150"},null,512),U(e.$slots,"default")],64))}}),ce="/game-demo/assets/1-12344dee.mp3",le="/game-demo/assets/2-374a1004.mp3",ue=s=>(J("data-v-a5ea9acc"),s=s(),K(),s),re={class:"main"},ie={class:"footer"},de=ue(()=>c("div",{class:"background"},null,-1)),ve=S({__name:"music",setup(s){const f=[ce,le],t=d(0),v=d(""),r=N(()=>v.value.isVoucl);function a(){t.value+=1,t.value>=f.length&&(t.value=0)}function h(){t.value-=1,t.value<0&&(t.value=f.length-1)}return M(()=>{console.log(v.value.isVoucl)}),(i,e)=>(g(),C(B,null,[c("div",re,[c("div",{class:X(["content",{rotato:m(r)}])},null,2),c("div",ie,[p(m(oe),null,{default:w(()=>[p(m(se),{ref_key:"player",ref:v,src:f[t.value],onPrev:a,onNext:h},null,8,["src"])]),_:1})])]),de],64))}});const pe=I(ve,[["__scopeId","data-v-a5ea9acc"]]);export{pe as default};
